defaultNamespace: tailscale
name: tailscale-crs
helm:
  releaseName: tailscale-crs
  chart: ./
  values:
    global:
      cluster: ${ .ClusterName }-${ get .ClusterLabels "cluster.homescale.cloud/region" }
      env: ${ get .ClusterLabels "cluster.homescale.cloud/env" }
    kubeProxy:
      replicas: 1
    ingressProxy:
      replicas: 2

# dependsOn:
#   - name: tailscale
#     acceptedStates:
#       - Ready

targetCustomizations:
  - name: prod
    clusterSelector:
      matchLabels:
        cluster.homescale.cloud/env: prod
    helm:
      values:
        kubeProxy:
          replicas: 2
        ingressProxy:
          replicas: 3
  - name: mgmt
    clusterSelector:
      matchLabels:
        cluster.homescale.cloud/env: mgmt
    helm:
      values:
        global:
          cluster: mgmt
        kubeProxy:
          replicas: 2
        ingressProxy:
          replicas: 3
