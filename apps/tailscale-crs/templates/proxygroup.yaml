apiVersion: tailscale.com/v1alpha1
kind: ProxyGroup
metadata:
  name: k8s-{{ .Values.cluster.name }}
spec:
  type: kube-apiserver
  replicas: {{ .Values.kubeProxy.replicas }}
  tags: ["tag:k8s", "tag:cluster-{{ .Values.cluster.name }}", "tag:region-{{ .Values.cluster.region }}"]
  kubeAPIServer:
    mode: auth
---
apiVersion: tailscale.com/v1alpha1
kind: ProxyGroup
metadata:
  name: ingress
spec:
  type: ingress
  replicas: {{ .Values.ingressProxy.replicas }}
  tags: ["tag:app", "tag:cluster-{{ .Values.cluster.name }}", "tag:region-{{ .Values.cluster.region }}"]
  hostnamePrefix: ingress-{{ .Values.cluster.name }}
